<B>Motivation:</B> Sequence alignment has been at the core of computational biology for half a century. Still, it is an open problem to design a practical algorithm for exact alignment of a pair of related sequences in linear-like time (Medvedev, 2022b).
<B>Methods:</B> We solve exact global pairwise alignment with respect to edit distance by using the A* shortest path algorithm. In order to efficiently align long sequences with high divergence, we extend the recently proposed <I>seed heuristic</I> (Ivanov et al., 2022) with <I>match chaining</I>, <I>gap costs</I>, and <I>inexact matches</I>. We additionally integrate the novel <I>match pruning</I> technique and diagonal transition (Ukkonen, 1985) to improve the A* search. We prove the correctness of our algorithm, implement it in the A*PA aligner, and justify our extensions intuitively and empirically.
<B>Results: </B>On random sequences of divergence d=4% and length n, the empirical runtime of A*PA scales near-linearly (best fit n^1.05, n&#8804;10^7bp). A similar scaling remains up to d=12% (best fit n^1.24, n&#8804;10^7bp). For n=10^7bp and d=4%, A*PA reaches >300x speedup compared to the leading exact aligners Edlib and BiWFA. The performance of A*PA is highly influenced by long gaps. On long (n>500kbp) ONT reads of a human sample it efficiently aligns sequences with d<10%, leading to 2x median speedup compared to Edlib and BiWFA. When the sequences come from different human samples, A*PA performs 1.4x faster than Edlib and BiWFA.
<B>Availability:</B> https://github.com/RagnarGrootKoerkamp/astar-pairwise-aligner
<B>Contact:</B> ragnar.grootkoerkamp@inf.ethz.ch, pesho@inf.ethz.ch
